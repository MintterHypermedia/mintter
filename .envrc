if [ $(uname) = "Darwin" ]; then
    if [ $(uname -m) = "x86_64" ]; then
        # We temporarily allow this for building Go 1.17 of Darwin x86_64.
        # See: https://discourse.nixos.org/t/missing-go-1-17-on-x86-64-darwin/15032.
        export NIXPKGS_ALLOW_UNSUPPORTED_SYSTEM=1
    fi
fi

use nix
watch_file shell.nix build/nix/**/*.nix

mkdir -p bin
rm -f bin/bazel
ln -s `which bazelisk` bin/bazel
PATH_add $(pwd)/bin
PATH_add $(pwd)/node_modules/.bin

export VITE_MINTTER_API_URL="http://localhost:55001"
