# We use this instead of use_nix to avoid polluting our environment with other variables nix-shell sets.
export PATH="$PWD/node_modules/.bin:$(nix run -f shell.nix -c 'bash' '-c' 'echo $PATH')"
watch_file shell.nix build/nix/**/*.nix
unset GOPATH
unset GOROOT

# This function should cleanup stuff from the old redo build system.
function remove_redo() {
    rm -rf .redo
    rm -f `find . -type f -name "*.list"`
    rm -rf ui-assets.gen.go rice-box.go
}

export GN_OUT_DIR="out"
[ -f "$GN_OUT_DIR/args.gn" ] || (rm -rf $GN_OUT_DIR && remove_redo && gn gen $GN_OUT_DIR)

export CURRENT_PLATFORM="$(go env GOOS)_$(go env GOARCH)"
export BAZEL_SH="$(which bash)"
export CGO_ENABLED="0"
export VITE_MINTTER_API_URL="http://localhost:55001"